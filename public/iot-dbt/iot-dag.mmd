graph LR
    subgraph Sources
        A[raw_events]
        C[devices]
        E[locations]
    end

    subgraph Staging
        B[stg_raw_events]
        D[stg_devices]
        F[stg_locations]
    end

    subgraph Intermediate
        H[int_error_rates]
        I[int_user_sessions]
        J[fct_sessions]
        G[int_device_utilization]
    end

    subgraph Marts
        L[building_utilization]
        K[device_health_dashboard]
        M[room_summary]
    end

    A --> B
    C --> D
    E --> F

    B --> G
    B --> H
    B --> I

    D --> G
    D --> H
    D --> I
    F --> G

    I --> J
    D --> J

    G --> K
    H --> K
    D --> K

    G --> L

    J --> M
    D --> M
    F --> M

    style A fill:#fef3c7,stroke:#f59e0b
    style C fill:#fef3c7,stroke:#f59e0b
    style E fill:#fef3c7,stroke:#f59e0b
    style B fill:#d1fae5,stroke:#10b981
    style D fill:#d1fae5,stroke:#10b981
    style F fill:#d1fae5,stroke:#10b981
    style G fill:#dbeafe,stroke:#3b82f6
    style H fill:#dbeafe,stroke:#3b82f6
    style I fill:#dbeafe,stroke:#3b82f6
    style J fill:#dbeafe,stroke:#3b82f6
    style K fill:#e9d5ff,stroke:#8b5cf6
    style L fill:#e9d5ff,stroke:#8b5cf6
    style M fill:#e9d5ff,stroke:#8b5cf6
